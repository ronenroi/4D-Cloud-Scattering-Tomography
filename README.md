# 4D Cloud Scattering Tomography
[![arXiv](https://img.shields.io/static/v1?label=ICCV2021&message=4DCloudCT&color=blueviolet)](https://openaccess.thecvf.com/content/ICCV2021/papers/Ronen_4D_Cloud_Scattering_Tomography_ICCV_2021_paper.pdf)

## Abstract
We derive computed tomography (CT) of a time-varying volumetric scattering object, using a small number of moving cameras. We focus on passive tomography of dynamic clouds, as clouds have a major effect on the Earth's climate. State of the art scattering CT assumes a static object. Existing 4D CT methods rely on a linear image formation model and often on significant priors. In this paper, the angular and temporal sampling rates needed for a proper recovery are discussed. Spatiotemporal CT is achieved using gradient-based optimization, which accounts for the correlation time of the dynamic object content. We demonstrate this in physics-based simulations and on experimental real-world data.
![4DcloudScatteringTomography](4DcloudScatteringTomography.png)

## Description
This repository contains the official implementation of 4D Cloud Scattering Tomography, which is implemented ontop of Pyshdom3.0 package [[1]].
Our framework recovers 4D cloud microphysics fields, using a small number of moving cameras. We exploits the natural temporal evolution of clouds for weighing the gradients of the different time steps for the recovery process.


[1]: https://github.com/aviadlevis/pyshdom


&nbsp;


## Installation 
Installation using using anaconda package management

Start a clean virtual environment
```
conda create -n pyshdom python=3
source activate pyshdom
```

Install required packages
```
conda install anaconda dill tensorflow tensorboard pillow joblib
```

Install pyshdom distribution with (either install or develop flag)
```
python setup.py develop
```

&nbsp;

### Data
We used cloud field data that were generated by Eshkol Eytan. Download [here](https://technionmail-my.sharepoint.com/:f:/g/personal/roironen_campus_technion_ac_il/EkwMkT74AdBMmFlD-blUIBsBPx79O3glbbVLo9CfRSYeSg?e=bjcPhv) the data and place it in 4D-Cloud-Scattering-Tomography/synthetic_cloud_fields/WIZ_Clouds/BOMEX2.
&nbsp;
For AirMSPI raw data please download the files from [here](https://technionmail-my.sharepoint.com/:f:/g/personal/roironen_campus_technion_ac_il/EpqZczvgj05NpC2JGPO8kjwBrI77-v5JKC9Cw7gJFkiPFA?e=YUPwwt) and place in 4D-Cloud-Scattering-Tomography/AirMSPI/21views.

## Main scripts
Scripts are devided into three categories: generate, render and optimize. For more information please read [here](https://github.com/ronenroi/4D-Cloud-Scattering-Tomography/blob/master/scripts/README.md).

To generate Mie scattering tables for cloud simulation and AirMSPI wavelengths
```sh
python scripts/generate_mie_tables.py  \
    --start_reff 4.0 --end_reff 25.0 --num_reff 50 --start_veff 0.01 --end_veff 0.2 --num veff 50 \
    --radius_cutoff 65.0 --wavelength 0.355 0.38 0.445 0.47 0.555 0.66 0.865 0.935
```

&nbsp;

## Usage and Contact
If you find this package useful please let me know at aviad.levis@gmail.com, I am interested.
If you use this package in an academic publication please acknowledge the appropriate publications (see LICENSE file). 

